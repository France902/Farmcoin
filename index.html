<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lezioni di Vue.js</title>

    <style>
        /* Reset e comportamento touch: disabilita scroll e selezione testo per evitare gesti non voluti in game */
        html, body {
            overflow: hidden;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
        }

        /* Body: font di sistema e colore di sfondo. L'uso di system fonts aiuta performance e coerenza */
        body {
            font-family: sans-serif;
            background-color: rgb(172, 247, 172);
        }

        /* Titoli principali: posizione fissa e z-index alto per apparire sopra la UI */
        h1 {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            text-align: center;
            position: fixed;
            z-index: 1;
        }
        h2 {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            text-align: center;
            position: fixed;
            z-index: 1;
        }

        /* Contenitore app: posizionamento assoluto per sovrapporre elementi */
        #app { position: absolute; }

        /* Immagine capanno posizionata con fixed*/
        #capanno {
            position: fixed;
            width: 20vw;
            height: auto;
            bottom: 60vh;
            left: 40.2vw;
            z-index: -9998;
        }

        #silo {
            position: fixed;
            width: 4.5vw;
            height: auto;
            bottom: 45vh;
            left: 34vw;
            z-index: -9998;
        }

        #ballaFieno {
            position: fixed;
            width: 3.5vw;
            height: auto;
            bottom: 46vh;
            left: 63.8vw;
            z-index: -9998;
        }

        #cesti {
            position: fixed;
            width: 3.5vw;
            height: auto;
            bottom: 60vh;
            left: 60vw;
            z-index: -9998;
        }

        #coltura {
            position: fixed;
            width: 1.8vw;
            height: auto;
            bottom: 83vh;
            left: 0vw;
            z-index: -9999;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        #tilemap {
            position: fixed;
            width: 22vw;
            height: 17vh;
            bottom: 71vh;
            left: 3vw;
            z-index: -9999;
            border-radius: 13%;
            opacity: 0;
            transition: opacity 1s ease;
        }

        /* Contenitore titolo: prospettiva per effetto 3D su testo sottostante */
        #containerTitolo {
            perspective: 27vh;
            width: 100vw;
            height: 30vh;
        }

        /* Icone di pulsanti*/
        #imgPrimaryButton {
            width: 4vw;
            height: auto;
            position: fixed;
            margin-left: -4.6vw;
            margin-top: -0.8vh;
        }
        #lucchetttoImg {
            width: 4vw;
            height: auto;
            position: fixed;
            margin-left: -7.6vw;
            margin-top: -1.8vh;
        }

        /* Money counter: centrato e con dimensione fissa in vh */
        #moneyCounter {
            position: fixed;
            height: 6vh;
            border-radius: 2vw;
            background-color: rgb(43, 215, 4, 0.7);
            border: 0.2vw solid black;
            display: inline-block;
            text-align: center;
            justify-content: center;
            align-items: center;
            padding: 0.5vh 2vw;
            font-size: 4vh;
            left: 50%;
            transform: translateX(-50%);
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            white-space: nowrap;
            transform-origin: center center;
        }

        /* Sotto titolo con effetto testo 3D (rotateX) */
        #sottoTitolo {
            font-size: 4vh;
            text-shadow: 0 0 0.2vw black;
            color: white;
            position: absolute;
            -webkit-text-stroke: 0.1vw black;
            top: 35vh;
            width: 100vw;
            transform: rotateX(25deg);
        }

        /* Overlay mappa: usato come maschera scura*/
        #overlayMappa {
            position: fixed;
            width: 100vw;
            height: 100vh;
            background-color: rgb(0, 0, 0);
            opacity: 0.3;
            top: 0vh;
            left: 0vw;
            z-index: -9997;
        }

        /* Elementi grafici posizionati e con z-index molto basso per stare sotto la UI */
        #stradaSterrata {
            position: fixed;
            width: 4vw;
            height: 47.5vh;
            bottom: -5vh;
            left: 48vw;
            z-index: -9999;
        }

        /* Contatore risorse piccolo in basso */
        .counter {
            position: absolute;
            width: 15vw;
            height: 5vh;
            border-radius: 4vw;
            background-color: rgb(227, 227, 3, 0.8);
            border: 0.2vw solid black;
            display: flex;
            text-align: end;
            justify-content: end;
            align-items: center;
            padding: 0.5vh 0.5vw;
            font-size: 3vh;
            top: 90vh;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            opacity: 0;
            transition: opacity 1s ease;
        }

        /* Pulsanti circolari principali: pointer-events inizialmente none, abilitati in JS*/
        .primaryButton {
            position: fixed;
            width: 5vw;
            height: 9vh;
            border-radius: 50%;
            background-color: rgb(227, 227, 3);
            margin-top: 6vh;
            margin-left: 3vw;
            cursor: pointer;
            font-size: 4vh;
            box-shadow: 0 0.4vw 0.8vw rgba(0, 0, 0, 0.3);
            border: 0.15vw solid black;
            transition: transform 0.08s ease, opacity 1s ease;
            pointer-events: none;
        }

        /* Titolo gigante con testo stroke */
        .titolo {
            font-size: 27vh;
            color: white;
            -webkit-text-stroke: 0.5vw black;
            position: fixed;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%) rotateX(25deg);
            transform-origin: center center;
            text-align: center;
            margin: 0;
            text-shadow: 0 0 10vw black;
            z-index: 1;
        }

        /* Recinzioni come immagini posizionate */
        .staccionataOrizzontale {
            position: fixed;
            width: 15vw;
            height: 4vh;
            bottom: 44.5vh;
            left: 33vw;
            z-index: -9998;
        }
        .staccionataVerticale {
            position: fixed;
            width: 0.4vw;
            height: 22vh;
            bottom: 45vh;
            left: 33.3vw;
            z-index: -9999;
        }

        /* Pulsante rettangolare usato per upgrade e unlock.*/
        .rettangularButton {
            position: fixed;
            height: 9vh;
            border-radius: 20%;
            background-color: #03a909ff;
            margin-top: 34vh;
            margin-left: 2vw;
            border: 1vw solid rgb(1, 1, 168);
            cursor: pointer;
            font-size: 4vh;
            box-shadow: 0 8vw 16vw rgba(0, 0, 0, 0.3);
            border: 0.15vw solid black;
            transition: transform 0.08s ease, opacity 1s ease;
            padding-left: 5vw;
            padding-right: 1vw;
            text-align: center;
            justify-content: center;
            align-items: center;
            pointer-events: none;
        }

        /* Bottoni di pagina principali*/
        .bottoniPagina {
            white-space: nowrap;
            transform-origin: center center;
            display: inline-block;
            text-align: center;
            justify-content: center;
            align-items: center;
            height: 10vh;
            font-size: 5vh;
            background-color: #4CAF50;
            color: green;
            border: none;
            border-radius: 8vw;
            cursor: pointer;
            position: fixed;
            z-index: 0;
            box-shadow: 0 0.3vw green;
            opacity: 0.9;
            top: 58vh;
            transform-origin: center center;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            font-weight: bold;
            padding: 0.5vh 4vw;
            left: 50%;
            transform: translateX(-50%);
        }
    </style>
</head>

<body>
    <!-- CANVAS di sfondo: gestito da drawMap() in JS -->
    <canvas id="canvas" style="position: fixed; z-index: -9999; opacity: 1; width: 100vw; height: 100vh; left: 0vw; top: 0vh;"></canvas>

    <!-- ROOT VUE -->
    <div id="app">

        <!-- MENU INIZIALE: start/setting ecc. -->
        <div id="menuGioco" style="position: fixed;">
            <div id="containerTitolo">
                <!-- Titolo principale grafico -->
                <h1 class="titolo">FARMCOIN</h1>

                <!-- Sottotitolo: usa transform 3D -->
                <h1 id="sottoTitolo">A farming game made with love</h1>
            </div>

            <!-- Pulsante Start: usa ref Vue per manipolazione diretta -->
            <button class="bottoniPagina"
                    id="bottoneStart"
                    ref="btnStart"
                    @mouseenter="onHoverStart"
                    @mouseleave="onLeaveStart"
                    @click="startGame">
                START
            </button>

            <!-- SETTINGS commentato: indicazione di feature future -->
            <!--
            <button class="bottoniPagina" id="bottoneSetting" ref="btnSetting" ...>SETTINGS</button>
            -->
        </div>

        <!-- SCHERMATA VITTORIA: inizialmente nascosta -->
        <div id="schermataVittoria" style="display: none;" ref="victoryScreen">
            <!-- Overlay scuro con ref -->
            <div id="overlayMappa" ref="overlayMap" style="z-index: 9999; opacity: 0.5;"></div>

            <h1 class="titolo" style="font-size: 7vh; top: 30vh; left: 50vw; z-index: 10000; -webkit-text-stroke: 0.3vw black;">CONGRATULATIONS!<br>YOU WON!</h1>

            <!-- Restart e Continue: usano refs per hover e click control -->
            <button class="bottoniPagina" id="bottoneRestart" ref="btnRestart"
                    @mouseenter="onHoverStart('restart')"
                    @mouseleave="onLeaveStart('restart')"
                    @click="restartGame"
                    style="top: 60vh; width: 30vw; z-index: 10000;">
                RESTART
            </button>

            <button class="bottoniPagina" id="bottoneContinue" ref="btnContinue"
                    @mouseenter="onHoverStart('continue')"
                    @mouseleave="onLeaveStart('continue')"
                    @click="continueGame"
                    style="top: 45vh; width: 30vw; z-index: 10000;">
                CONTINUE
            </button>
        </div>

        <!-- STRUTTURA DI GIOCO: contiene risorse, contatori e aree -->
        <div id="strutturaGioco" style="display: none; z-index: 9998;">
            <!-- Contatori risorse con binding Vue -->
            <div class="counter" :ref="el => counterButtons.push(el)">{{ contMais }}üåΩ
                <h1 style="transition: opacity 1s ease; opacity: 1; font-size: 3.3vh; position: fixed; left: 2vw;" :ref="el => textCycle.push(el)">lv. {{livelloUpgrade[0]+1}}</h1>
            </div>
            <div class="counter" :ref="el => counterButtons.push(el)" style="left: 35vh; background-color: orange;">{{ contCarrot }}ü•ï
                <h1 style="transition: opacity 1s ease; opacity: 1; font-size: 3.3vh; position: fixed; left: 21vw;" :ref="el => textCycle.push(el)">lv. {{livelloUpgrade[1]+1}}</h1>
            </div>
            <div class="counter" :ref="el => counterButtons.push(el)" style="left: 70vh; background-color: rgb(188, 2, 2);">{{ contTomatoes }}üçÖ
                <h1 style="transition: opacity 1s ease; opacity: 1; font-size: 3.3vh; position: fixed; left: 40.7vw;" :ref="el => textCycle.push(el)">lv. {{livelloUpgrade[2]+1}}</h1>
            </div>
            <div class="counter" :ref="el => counterButtons.push(el)" style="left: 105vh; background-color: purple;">{{ contPotatoes }}ü•î
                <h1 style="transition: opacity 1s ease; opacity: 1; font-size: 3.3vh; position: fixed; left: 60.3vw;" :ref="el => textCycle.push(el)">lv. {{livelloUpgrade[3]+1}}</h1>
            </div>

            <!-- Money counter centrale -->
            <div id="moneyCounter">{{ money }}$</div>

            <!-- FIRST AREA: elementi interattivi per la prima risorsa -->
            <div ref="firstArea" style="position: absolute; width: 30vw; height: 30vh; z-index: 9998; top: -5vh;">
                <button class="primaryButton" @click="click(0)" :ref="el => clickButtons.push(el)">üåΩ</button>

                <!-- Pulsante vendi: nascosto con opacity 0 finch√© risorsa < 10 -->
                <button class="primaryButton" @click="sell(0)" :ref="el => sellButtons.push(el)"
                        style="opacity: 0; background-color: rgba(3, 227, 3, 0.8); margin-left: 11vw;">$</button>

                <!-- Upgrade button: inizialmente invisibile, contenente icona -->
                <button class="rettangularButton" @click="upgrade(0)" :ref="el => upgradeButtons.push(el)" style="opacity: 0;">
                    <img src="upgrade_icon.png" id="imgPrimaryButton">
                    {{ costoUpgrade[0] }}$
                </button>

                <!-- Auto-clicker: nascosto finch√© non sbloccato via upgrade -->
                <button class="rettangularButton" @click="autoClicker(0)" :ref="el => autoClickers.push(el)"
                        style="opacity: 0; margin-left: 20vw; margin-top: 8vh; padding: 0.5vw; font-size: 3vh; background-color: rgb(166, 2, 2); border-radius: 15%;">
                    +{{contAutoClicker[0]+1}} auto clicker {{ (contAutoClicker[0]+1) * autoClickerCost[0] }}$
                </button>
            </div>

            <!-- Bottone sblocco area 2 -->
            <button class="rettangularButton" @click="unlockArea(1)" :ref="el => unlockAreaButtons.push(el)"
                    style="opacity: 0; width: 20vw; height: 10vh; top: 30vh; background-color: gray;">
                <img src="lucchetto.png" id="lucchetttoImg">
                {{ costoArea[0] }}$
            </button>

            <!-- SECOND AREA: inizialmente display none e pointer-events none -->
            <div ref="secondArea" style=" top: 42vh; z-index: 9998; position: absolute; pointer-events: none; width: 50vw; height: 50vh; display: none;">
                <button class="primaryButton" @click="click(1)" :ref="el => clickButtons.push(el)" style="background-color: orange;">ü•ï</button>
                <button class="primaryButton" @click="sell(1)" :ref="el => sellButtons.push(el)" style="opacity: 0; background-color: rgba(3, 227, 3, 0.8); margin-left: 11vw;">$</button>
                <button class="rettangularButton" @click="upgrade(1)" :ref="el => upgradeButtons.push(el)" style="opacity: 0;">
                    <img src="upgrade_icon.png" id="imgPrimaryButton">
                    {{ costoUpgrade[1] }}$
                </button>
                <button class="rettangularButton" @click="autoClicker(1)" :ref="el => autoClickers.push(el)" style="opacity: 0; margin-left: 20vw; margin-top: 8vh; padding: 0.5vw; font-size: 3vh; background-color: rgb(166, 2, 2); border-radius: 15%;">
                    +{{contAutoClicker[1]+1}} auto clicker {{ (contAutoClicker[1]+1) * autoClickerCost[1] }}$
                </button>
            </div>

            <!-- Bottone sblocco area 3 -->
            <button class="rettangularButton" @click="unlockArea(2)" :ref="el => unlockAreaButtons.push(el)"
                    style="opacity: 0; width: 20vw; height: 10vh; left: 75vw; top: -15vh; background-color: gray;">
                <img src="lucchetto.png" id="lucchetttoImg">
                {{ costoArea[1] }}$
            </button>

            <!-- THIRD AREA -->
            <div ref="thirdArea" style="left: 75vw; top: -5vh; z-index: 9998; position: absolute; pointer-events: none; width: 50vw; height: 50vh; display: none;">
                <button class="primaryButton" @click="click(2)" :ref="el => clickButtons.push(el)" style="background-color: rgb(188, 2, 2); margin-left: 17vw;">üçÖ</button>
                <button class="primaryButton" @click="sell(2)" :ref="el => sellButtons.push(el)" style="opacity: 0; background-color: rgba(3, 227, 3, 0.8); margin-left: 9vw;">$</button>
                <button class="rettangularButton" @click="upgrade(2)" :ref="el => upgradeButtons.push(el)" style="opacity: 0; margin-left: 12vw;">
                    <img src="upgrade_icon.png" id="imgPrimaryButton">
                    {{ costoUpgrade[2] }}$
                </button>
                <button class="rettangularButton" @click="autoClicker(2)" :ref="el => autoClickers.push(el)" style="opacity: 0; margin-left: -7vw; margin-top: 8vh; padding: 0.5vw; font-size: 3vh; background-color: rgb(166, 2, 2); border-radius: 15%;">
                    +{{contAutoClicker[2]+1}} auto clicker {{ (contAutoClicker[2]+1) *autoClickerCost[2] }}$
                </button>
            </div>

            <!-- Bottone sblocco area 4 -->
            <button class="rettangularButton" @click="unlockArea(3)" :ref="el => unlockAreaButtons.push(el)"
                    style="opacity: 0; width: 20vw; height: 10vh; left: 75vw; top: 30vh; background-color: gray;">
                <img src="lucchetto.png" id="lucchetttoImg">
                {{ costoArea[2] }}$
            </button>

            <!-- FOURTH AREA -->
            <div ref="fourthArea" style="left: 75vw; top: 42vh; z-index: 9998; position: absolute; pointer-events: none; width: 50vw; height: 50vh; display: none;">
                <button class="primaryButton" @click="click(3)" :ref="el => clickButtons.push(el)" style="background-color: rgb(188, 2, 2); margin-left: 17vw;">ü•î</button>
                <button class="primaryButton" @click="sell(3)" :ref="el => sellButtons.push(el)" style="opacity: 0; background-color: rgba(3, 227, 3, 0.8); margin-left: 9vw;">$</button>
                <button class="rettangularButton" @click="upgrade(3)" :ref="el => upgradeButtons.push(el)" style="opacity: 0; margin-left: 12vw;">
                    <img src="upgrade_icon.png" id="imgPrimaryButton">
                    {{ costoUpgrade[3] }}$
                </button>
                <button class="rettangularButton" @click="autoClicker(3)" :ref="el => autoClickers.push(el)" style="opacity: 0; margin-left: -7vw; margin-top: 8vh; padding: 0.5vw; font-size: 3vh; background-color: rgb(166, 2, 2); border-radius: 15%;">
                    +{{contAutoClicker[3]+1}} auto clicker {{ (contAutoClicker[3]+1) * autoClickerCost[3] }}$
                </button>
            </div>
        </div>

        <!-- OGGETTI DI MAPPA: immagini decorative posizionate sotto la UI -->
        <div id="oggettiMappa" style="z-index: -9999;">
            <div id="overlayMappa" ref="overlayMap"></div> 
            <img src="silo.png" id="silo" style="bottom: 55vh;">
            <img src="silo.png" id="silo">
            <img src="cesti.png" id="cesti">
            <img src="cesti.png" id="cesti" style="left: 63.5vw;">
            <img src="HayBale.png" id="ballaFieno" style="bottom: 52vh;">
            <img src="HayBale.png" id="ballaFieno">
            <img src="barn.png" id="capanno">
            <img src="road.png" id="stradaSterrata">
            <img src="horizontal_fence.png" class="staccionataOrizzontale" alt="Recinzione orizzontale">
            <img src="horizontal_fence.png" class="staccionataOrizzontale" style="left: 52.5vw;" alt="Recinzione orizzontale">
            <img src="horizontal_fence.png" class="staccionataOrizzontale" style="bottom: 63.5vh; z-index: -9999; left: 33.05vw;" alt="Recinzione orizzontale">
            <img src="horizontal_fence.png" class="staccionataOrizzontale" style="bottom: 63.5vh; z-index: -9999; left: 52.5vw; " alt="Recinzione orizzontale">
            <img src="vertical_fence.png" class="staccionataVerticale" alt="Recinzione verticale">
            <img src="vertical_fence.png" class="staccionataVerticale" style="left: 67vw;" alt="Recinzione verticale">
            <img src="tilemap.png" id="tilemap" :ref="el => tilemaps.push(el)">
            <img src="tilemap.png" id="tilemap" style="bottom: 24vh;" :ref="el => tilemaps.push(el)">
            <img src="tilemap.png" id="tilemap" style="left: 77vw;" :ref="el => tilemaps.push(el)">
            <img src="tilemap.png" id="tilemap" style="bottom: 24vh; left: 77vw;" :ref="el => tilemaps.push(el)">
            
        </div>
     </div>

   <!-- Vue e JS app -->
   <script src="https://unpkg.com/vue@3"></script>
   <script src="./app.js"></script>
</body>
</html>
